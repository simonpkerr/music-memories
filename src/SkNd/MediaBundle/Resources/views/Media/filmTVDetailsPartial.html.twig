{% macro m_mediaResource(item, media, decade, genre) %}
<li class="clear">
    <a title="see more details for {{item.ItemAttributes.Title}}" href="{{path('mediaDetails', {'media':media, 'decade':decade, 'genre':genre, 'id':item.ASIN })}}" class="fl">
        <img src="{{item.MediumImage is defined ? item.MediumImage.URL : asset('bundles/SkNd/images/image-placeholder.jpg') }}" alt="{{item.ItemAttributes.Title}}" />
    </a>
    <a href="{{path('mediaDetails', {'media':media, 'decade':decade, 'genre':genre, 'id':item.ASIN })}}">
        <strong>{{item.ItemAttributes.Title}}</strong>
    </a>
    
    <ul class="actions">
        <li><a title="see more details for {{item.ItemAttributes.Title}}" href="{{path('mediaDetails', {'media':media, 'decade':decade, 'genre':genre, 'id':item.ASIN })}}">Explore this item</a></li>
        <li><a target="_blank" href="{{item.DetailPageURL}}">Buy from Amazon{% if item.ItemAttributes.ListPrice is defined %} for {{ item.ItemAttributes.ListPrice.FormattedPrice }}{% endif %}</a></li>
    </ul>
</li>
{% endmacro %}

{% macro m_mediaResourceDetails(mr) %}
<ul>
    <li>Viewcount: {{mr.viewCount}}</li>
    <li>Selected Count: {{mr.selectedCount}}</li>
    <li>Date updated: {{mr.lastUpdated|date('d/m/y')}}</li>
</ul>

{% endmacro %}
    

{% if mediaResource is defined %}
{% set item = mediaResource.mediaResourceCache.xmlData %}

{#% debug item %#}
<div class="two-thirds-width fl">
    <div id="itemOverview">
        <img src="{{item.MediumImage.URL}}" alt="{{item.ItemAttributes.Title}}" />
        {#<p>{{ item.EditorialReviews.EditorialReview.Content }}</p>#}
        <ul class="actions">
            {% include "SkNdUserBundle:MemoryWall:addToMemoryWallListPartial.html.twig" 
                with {
                'api'       : api,
                'itemId'    : item.ASIN,
                'itemTitle' : item.ItemAttributes.Title
                } 
            %}
            <li class="buy-it"><a class="button" target="_blank" href="{{item.DetailPageURL}}">Buy this from Amazon{% if item.ItemAttributes.ListPrice is defined %} for {{ item.ItemAttributes.ListPrice.FormattedPrice }}{% endif %}</a></li>
        </ul>

        {% if item.SimilarProducts is defined %}
        <div id="similarItems">
            <h2>Similar Items</h2>
            <ul>
            {% for similarItem in item.SimilarProducts.SimilarProduct %}
                <li>
                    <a title="see more details for {{similarItem.Title}}" href="{{path('mediaDetails', {'media':media, 'decade':decade, 'genre':genre, 'id':similarItem.ASIN })}}">{{similarItem.Title}}</a>
                </li>
            {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>
        
    <div id="youtubeTopresults">
    <h2>YouTube videos</h2>
    {% 
        render "SkNdMediaBundle:Media:youTubeRequest" with {
            'title'     :   item.ItemAttributes.Title|url_encode, 
            'media'     :   media,
            'decade'    :   decade,
            'genre'     :   genre
        } 
    %}
    </div>

{#%<div id="googleImagesTopresults">
<h2>Top Images</h2>

    render "SkNdMediaBundle:Media:flickrRequest" with {
        'title'     :   item.ItemAttributes.Title|url_encode, 
        'media'     :   media,
        'decade'    :   decade,
        'genre'     :   genre,
    }

</div>        %#}

</div>        
        
<div id="recommendations" class="third-width fr">
    <h2>Recommended</h2>
    {% set recommendations = mediaResource.relatedMediaResources %}
    {% if recommendations.exactMatches is not empty %}
    <div id="exact-recommendations">
        <p class="strapline">Here are some items just like the one you chose.</p>
        {% for mr in recommendations.exactMatches %}
            {{ _self.m_mediaResource(mr.mediaResourceCache.xmlData, media, decade, genre) }}
        {% endfor %}
        </ul>
    </div>
    {% endif %}
    
    {% if recommendations.genericMatches is not empty %}
        <div id="generic-recommendations" class="clear">
        <h3>You might also like</h3>
        <p class="strapline">Here&rsquo;s some other stuff you might be interested in.</p>
        <ul>
        {% for mr in recommendations.genericMatches %}
            {{ _self.m_mediaResource(mr.mediaResourceCache.xmlData, media, decade, genre) }}
        {% endfor %}
        </ul>
    </div>
    {% endif %}
        
    {% if recommendations.exactMatches is empty and recommendations.genericMatches is empty %}   
        <p class="strapline">Hmmm&hellip;there doesn&rsquo;t seem to be any recommendations for this item, sorry!</p>
    {% endif %}   
        
</div>

{% endif %}


